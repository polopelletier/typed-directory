# Typed directory

[![NPM version](https://badge.fury.io/js/typed-directory.svg)](http://badge.fury.io/js/typed-directory)

_Typed-directory_ is an utility that will generate a strongly typed hierarchy of a specific folder. It is useful for typescript projects that need dynamic imports but don't want to give-up type annotation.

## Installation
```bash
# Install globaly
npm install -g typed-directory

# or
# Add to your own module
npm install --save-dev typed-directory
```

## Usage
Basic usage take an input directory and a typescript file and output a hierarchy of the file.

```bash
typed-directory -d examples/animals/content -t examples/animals/Animal.ts -o examples/animals/output.ts
```

## Configuration file

### Format
Configuration file must export an Array compilable entries. Each entry must have the following keys:
- __dir:String__ - Path to the directory containing your source files (relative to project root)
- __type:String__ - Path to the typescript file exporting the type description of all files contained in source directory (relative to project root)
- __output:String__ - Path to the typescript file that must be generated (relative to project root)
- __[instance:Boolean]__ _(Optional: default=false)_ - See section [is instance](#is-instance)


```javascript
// typed-directory.config.js
module.exports = [
	{
		dir: "examples/animals/content",
		type: "examples/animals/Animal.ts",
		output: "examples/animals/output.ts"
	}
];
```

__Note__: It is also possible to use __json__ format for your config file.

### Default config
While it is possible to specify your own config filename, it is recommended to use the default config. It must be located next to your __package.json__ in your project directory and be named __typed-directory.config.js__.

## Command-line tool
```bash
# Use default config
typed-directory

# Use specific config
typed-directory -c examples/config/typed-directory.config.json

# Use specified path
typed-directory -d examples/classes/content -t examples/classes/BaseClass.ts -o examples/classes/output.ts

# Print the full documentation for the command-line tool
typed-directory --help
```

## Use as a module
TODO: import runner or watch as compiler

#### compiler()
Run compiler using default config file

#### compiler(configFilename)
Run compiler using a custom config file
- __configFilename:String__ - Path to

#### compiler(outputFilename, typeFilename, contentDirectory[, isInstance=false])
Run compiler by specifying the paths for one entry
- __outputFilename:String__ - Path to
- __typeFilename:String__ - Path to
- __contentDirectory:String__ - Path to
- __[isInstance:Boolean]__ _(Optional: default=false)_ - See section [is instance](#is-instance)

#### compiler(entries)
Run compiler by specifying the paths for multiple entries
- __entries:Array__ - List of entries
- __entries[n].dir:String__ - Path to the directory containing your source files (relative to project root)
- __entries[n].type:String__ - Path to the typescript file exporting the type description of all files contained in source directory (relative to project root)
- __entries[n].output:String__ - Path to the typescript file that must be generated (relative to project root)
- __[entries[n].instance:Boolean]__ _(Optional: default=false)_ - See section [is instance](#is-instance)


## Watch
TODO

## Using with third-party libraries

### Nodemon
If you already use the default config file, using _typed-directory_ with _nodemon_ should be as easy as calling the command-line tool from a hook in your __nodemon.json__:
```json
{
	"events": {
		"start": "typed-directory"
	},
	"ignore": [
		// NOTE: Adding all output files here would be a great idea since nodemon will restart after
	],
	// The rest of your nodemon.json is up to you...
}
```

### Webpack
(WIP)

## Is instance

### Import content as sub-classes (default)
Type is _{new(): BaseClass}_, therefore _Something_ is a class that __extends__ _BaseClass_
```typescript
import BaseClass from "./BaseClass";

import _Something from "./content/Something";

// Casting as sub-class of BaseClass
const Something:{new(): BaseClass} = _Something;

export default {
	"Something": Something
};
```

### Import content as instances
Type is _Animal_, therefore _cat_ is an __instance__ of _Animal_
```typescript
import Animal from "./Animal";

import _cat from "./content/domestic/cat";

// Casting as instance of Animal
const cat:Animal = _cat;

export default {
	"domestic": {
		"cat": cat
	}
};
```

## Tests
Test can be run by using the test command:
```bash
npm run test
```

Coverage data can also be generated by running the coverage command:
```bash
npm run coverage
```

-----------
# Other
### Readonly and timestamp